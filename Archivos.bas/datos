Attribute VB_Name = "datos"
' variables publicas para tabla de replanteo
Public caso As String, tip_mac As String, tip_poste As String, num_poste As String
Public uno As Integer
Public alt_nom As Double, alt_max As Double, alt_min As Double, dist_va_max As Double
Public canton_max As Double, va_max_comp As Double, va_max_aire As Double, va_max_tunel As Double
Public inc_va As Double, dist_carril_poste As Double, va_max As Double, inc_alt_hc As Double
Public fin As Double, inicio As Double, start As Double, l_canton As Double
Public radio_recta As Double
Public Error As Long, n_canton2 As Long
Sub auto_close()
Excel.Application.VBE.ActiveVBProject.VBComponents("principal").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\principal")
Excel.Application.VBE.ActiveVBProject.VBComponents("aguja").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\aguja")
Excel.Application.VBE.ActiveVBProject.VBComponents("altura").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\principal")
Excel.Application.VBE.ActiveVBProject.VBComponents("cad").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\altura")
Excel.Application.VBE.ActiveVBProject.VBComponents("cantonamiento").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\cantonamiento")
Excel.Application.VBE.ActiveVBProject.VBComponents("datos").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\datos")
Excel.Application.VBE.ActiveVBProject.VBComponents("descentramiento").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\descentramiento")
Excel.Application.VBE.ActiveVBProject.VBComponents("num_postes").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\num_postes")
Excel.Application.VBE.ActiveVBProject.VBComponents("paso_superior").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\paso_superior")
Excel.Application.VBE.ActiveVBProject.VBComponents("pk_real").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\pk_real")
Excel.Application.VBE.ActiveVBProject.VBComponents("punto_singular").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\punto_singular")
Excel.Application.VBE.ActiveVBProject.VBComponents("radio").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\radio")
Excel.Application.VBE.ActiveVBProject.VBComponents("regulacion").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\regulacion")
Excel.Application.VBE.ActiveVBProject.VBComponents("revision").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\revision")
Excel.Application.VBE.ActiveVBProject.VBComponents("vano").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\vano")
Excel.Application.VBE.ActiveVBProject.VBComponents("viaducto").Export ("C:\Documents and Settings\23370\Escritorio\SiReCa\Archivos.bas\viaducto")


End Sub


Sub datos_excel()


alt_nom = Sheets(2).Cells(24, 4).Value
alt_min = Sheets(2).Cells(25, 4).Value
alt_max = Sheets(2).Cells(26, 4).Value
alt_cat = Sheets(2).Cells(27, 4).Value
dist_va_max = Sheets(2).Cells(28, 4).Value
canton_max = Sheets(2).Cells(29, 4).Value
va_max_sec_comp = Sheets(2).Cells(30, 4).Value
va_max_sec_aire = Sheets(2).Cells(31, 4).Value
va_max_tunel = Sheets(2).Cells(32, 4).Value
inc_va = Sheets(2).Cells(36, 4).Value
dist_carril_poste = Sheets(2).Cells(37, 4).Value
va_max = Sheets(2).Cells(3, 8).Value
inc_alt_hc = Sheets(2).Cells(37, 4).Value
radio_recta = Sheets(2).Cells(39, 4).Value
uno = 1
cadena = ActiveWorkbook.Path                            ' dirección de este archivo
UserForm1.Show                                          ' mostrar pk de entrada / salida
inicio = UserForm1.TextBox1.Value                       ' inicio = pk inicio
Sheets(1).Cells(10, 33) = inicio
fin = UserForm3.TextBox1.Value                          ' final = pk final
start = inicio
l_canton = 0
End Sub

