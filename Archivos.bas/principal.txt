Attribute VB_Name = "principal"
' variables publicas para tabla de replanteo
Public caso As String, tip_mac As String, tip_poste As String, num_poste As String
Public n_min_va_sm As Integer, n_min_va_sla As Integer
Public alt_nom As Double, alt_max As Double, alt_min As Double, dist_va_max As Double
Public dist_max_canton As Double, va_max_sm As Double, va_max_sla As Double, va_max_tunel As Double
Public inc_norm_va As Double, dist_carril_poste As Double, va_max As Double, inc_max_alt_hc As Double
Public d_max_cu As Double
Public inicio As Double, fin As Double
Public r_re As Double, alt_cat As Double, va_max_sec_comp As Double, d_max_re As Double
Public va_max_sec_aire As Long, fallo As Double, ancho_via As Double
Public Error As Long, n_canton2 As Long
Function principal(inicio1, h1, w1, k1, a1, b1, c1, r_re1, dist_va_max1, inc_norm_va1, va_max_tunel1, va_max1) As Long()
inicio = inicio1
h = h1
w = w1
k = k1
a = a1
b = b1
c = c1
r_re = r_re1
dist_va_max = dist_va_max1
inc_norm_va = inc_norm_va1
va_max_tunel = va_max_tunel1
va_max = va_max1
'recolección de datos e inicialización

If h = 10 Then
'Call datos.datos_excel
'inicializar todos los contadores

Sheets(1).Cells(10, 33) = inicio1
End If

                        ' inicializamos 3 vanos para poder corregirlos
While 16 > h

    
    Call radio.radio(h, k)                                    ' calculamos el radio para el pk
    Sheets(1).Cells(h + 1, 4).Value = vano.vano(Sheets(1).Cells(h, 6).Value)           ' al radio buscado le corresponde un vano
    h = h + 2                                           ' avanzamos una fila y calculamos un nuevo pk
    Sheets(1).Cells(h, 33).Value = Sheets(1).Cells(h - 1, 4) + Sheets(1).Cells(h - 2, 33)
Wend

    Call radio.radio(h, k)                                    ' calculamos el radio para el pk
    Sheets(1).Cells(h + 1, 4).Value = vano.vano(Sheets(1).Cells(h, 6).Value)           ' al radio buscado le corresponde un vano
    Call regulacion.regulacion(h, k, a, b)                                  ' comprobamos que los incrementos de vano
    Call punto_singular.sing(h, k, a, b)                            ' comprobamos que el poste no cae en un PS
    Call punto_singular.sing1(h, a, k)                                ' comprobamos que el poste no cae en un PS
    'Call cantones(h, c, k, a)
    h = h + 2                                           'avanzamos una fila y calculamos nuevo pk
    Sheets(1).Cells(h, 33).Value = Sheets(1).Cells(h - 1, 4) + Sheets(1).Cells(h - 2, 33)
    Dim x(7) As Long
        x(0) = inicio
        x(1) = h
        x(2) = w
        x(3) = k
        x(4) = a
        x(5) = b
        x(6) = c
        x(7) = Sheets(1).Cells(h, 33).Value

    principal = x

    
End Function


