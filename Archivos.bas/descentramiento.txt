Attribute VB_Name = "descentramiento"
Sub desc()
Dim z As Integer, m As Integer
Dim descentramiento As Double, rady As Double
z = 10
While Not IsEmpty(Sheets(1).Cells(z, 33).Value)
m = 3
If Sheets(1).Cells(z, 6).Value < 0 Then
    rady = Sheets(1).Cells(z, 6).Value * (-1)
Else
    rady = Sheets(1).Cells(z, 6).Value
End If
' buscar en que fila de la hoja 2 se encuentra el radio que buscamos
If Not IsEmpty(Sheets(1).Cells(z, 6).Value) Then
    While rady <= Sheets(2).Cells(m, 2).Value And _
        rady > Sheets(2).Cells(m, 3).Value
        m = m + 1
    Wend
Else
        m = 3
End If
descentramiento = Sheets(2).Cells(m, 5).Value

' el descentramiento varia segun el sentido de giro de la curva
' el descentramiento anterior y posterior varian de signo en recta
If Not IsEmpty(Sheets(1).Cells(z, 6).Value) Then
    If Sheets(1).Cells(z, 6).Value >= 0 Then
        Sheets(1).Cells(z, 8).Value = descentramiento
    Else
      Sheets(1).Cells(z, 8).Value = descentramiento * (-1)
    End If
ElseIf IsEmpty(Sheets(1).Cells(z, 6).Value) Then
    If Sheets(1).Cells(z - 2, 8).Value = descentramiento Then
        Sheets(1).Cells(z, 8).Value = Sheets(2).Cells(m, 4).Value
    Else
        Sheets(1).Cells(z, 8).Value = descentramiento
    End If
End If

z = z + 2
Wend
End Sub

