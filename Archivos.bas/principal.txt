Attribute VB_Name = "principal"
' variables publicas para tabla de replanteo
Public caso As String, tip_mac As String, tip_poste As String, num_poste As String
Public uno As Integer
Public alt_nom As Double, alt_max As Double, alt_min As Double, dist_va_max As Double
Public canton_max As Double, va_max_comp As Double, va_max_aire As Double, va_max_tunel As Double
Public inc_va As Double, dist_carril_poste As Double, va_max As Double, inc_alt_hc As Double
Public fin As Double, inicio As Double, start As Double, l_canton As Double
Public radio_recta As Double
Public Error As Long, n_canton2 As Long
Function principal(inicioVB, hVB, wVB, kVB, aVB, bVB, cVB) As Long()
Dim w As Integer, h As Integer, k As Integer, a As Integer, b As Integer
Dim c As Integer

'recolección de datos e inicialización

inicio = inicioVB

If hVB = 10 Then
Call datos.datos_excel
'inicializar todos los contadores

Sheets(1).Cells(10, 33) = inicio
End If
a = aVB
b = bVB
c = cVB
h = hVB
k = kVB
w = wVB
                        ' inicializamos 3 vanos para poder corregirlos
While 16 > h

    
    Call radio.radio(h, k)                                    ' calculamos el radio para el pk
    Sheets(1).Cells(h + 1, 4).Value = vano.vano(Sheets(1).Cells(h, 6).Value)           ' al radio buscado le corresponde un vano
    h = h + 2                                           ' avanzamos una fila y calculamos un nuevo pk
    Sheets(1).Cells(h, 33).Value = Sheets(1).Cells(h - 1, 4) + Sheets(1).Cells(h - 2, 33)
Wend

    Call radio.radio(h, k)                                    ' calculamos el radio para el pk
    Sheets(1).Cells(h + 1, 4).Value = vano.vano(Sheets(1).Cells(h, 6).Value)           ' al radio buscado le corresponde un vano
    Call regulacion.regulacion(h, k, a, b)                                  ' comprobamos que los incrementos de vano
    Call punto_singular.sing(h, k, a, b)                            ' comprobamos que el poste no cae en un PS
    Call punto_singular.sing1(h, a, k)                                ' comprobamos que el poste no cae en un PS
    'Call cantones(h, c, k, a)
    h = h + 2                                           'avanzamos una fila y calculamos nuevo pk
    Sheets(1).Cells(h, 33).Value = Sheets(1).Cells(h - 1, 4) + Sheets(1).Cells(h - 2, 33)
    Dim x(7) As Long
        x(0) = inicio
        x(1) = h
        x(2) = w
        x(3) = k
        x(4) = a
        x(5) = b
        x(6) = c
        x(7) = Sheets(1).Cells(h, 33).Value

    principal = x

    
End Function


